<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>lesson 9</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="secret-agent-man">Secret Agent, Man</h1>
<p>In this lesson, you will:<br>
1.<br>
2.<br>
3.<br>
4.</p>
<h2 id="where-we-left-off">Where We Left Off</h2>
<p>Last lesson,</p>
<h2 id="helpful-links">Helpful Links</h2>
<p><a href="http://editor.p5js.org">Editor</a>: the online p5.js editor<br>
<a href="http://reference.p5js.org">Reference</a>: documentation for all things in p5.js<br>
<a href="http://bit.ly/p5jsLesson9">Lesson 9 starter</a>: rearranged and simplified code from the end of Lesson 8</p>
<h2 id="getting-started">Getting Started</h2>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> As usual, we have some <a href="https://bit.ly/p5jsLesson9">starter code</a>. Go ahead and load up that link and take a look around.</li>
</ul>
<h2 id="filed-away">Filed Away</h2>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> If you run this code, you’ll notice that after accounting for the randomness we put in, it looks exactly like what <a href="https://bit.ly/p5jsLesson8final">ended the previous lesson</a>. But if you <em>look</em> at this code, you’ll notice that a lot seems to be missing.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Scroll down to the bottom of the starter code. It’s just 66 lines — a far cry from the 250-odd we had in the other lesson — with no sign of our Ball and Face code anywhere. What gives?</p>
</li>
</ul>
<p>For this entire time, we have been working in a single JavaScript file called <em>sketch.js</em>. We could continue working like that, but we are going to add a lot of code in the next two lessons and rather than scrolling back and forth, it’ll be easier to manage with separate files.</p>
<p>So that’s the secret — our code is in another castle.</p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Next to where it says <em>sketch.js</em> is a button with a small chevron, kind of like a <em>greater than symbol</em> or <em>closing angle bracket</em> <code>&gt;</code> but a little less sharp. Click it.</li>
</ul>
<p><img src="chevronButton.png" alt="the chevron button"></p>
<p><img src="showFiles.png" alt="reveal sidebar to show files"></p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Click on the file names in this sidebar we revealed. Take a look inside each. Which one has (most of) our code from before?</li>
</ul>
<blockquote>
<p>hint: The rest of the code is in <em>shapes.js</em>.</p>
</blockquote>
<p>If you have worked with HTML and CSS, you’ll recognize the other files in the sidebar. And if you haven’t, well, these are very small HTML and CSS files.</p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Select <em>index.html</em>. This is an HTML, obviously. Whenever we add another JS file to our project, we need to add a line to tell the HTML file to include it, otherwise, it will just be ignored.</li>
</ul>
<p>In the body — the part between the <code>&lt;body&gt;&lt;/body&gt;</code> tags, you’ll see a a couple <code>&lt;script&gt;</code> tags:</p>
<pre><code>  &lt;script src="sketch.js"&gt;&lt;/script&gt;
  &lt;script src="shapes.js"&gt;&lt;/script&gt;
</code></pre>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Copy the second of these lines and paste it immediately below it.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Instead of <code>shapes.js</code>, put <code>agents.js</code>. Be sure the quotes enclose it.</p>
</li>
</ul>
<p><img src="addAgentsHTML.png" alt="agents.js added to HTML file"></p>
<p>We are going to put the code for the interactive things in our game with in a file called <em>agents.js</em> which doesn’t yet exist. We should probably make it.</p>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> To create a file, we have to first make sure that we are logged in.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> When we are logged in, there will be a downward pointing triangle next to <em>sketch.js</em>. Click it to reveal a menu. Choose <em>Create File</em> and name it <em>agents.js</em>.</p>
</li>
</ul>
<p><img src="createFile.png" alt="menu with *create file*"></p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> When we look at our new file, the blank minimalism of possibility looks back. Do not be afraid. This is normal.</li>
</ul>
<p>Creating a new file raises the question: How many files <em>should</em> we have? We are going to end up with several classes, many based on <em>Ball</em> and <em>Face</em>. We could put each class in its own file. We could put them all in the one created here. We can do a blend. So which one is right?</p>
<p>It’s better to look at what you want these classes to do. We will do a blend, not because it’s the best or the cleanest, but because it will make most things easy enough to deal with.</p>
<p>In the end, we’ll have a <em>sketch.js</em> where all the instantiation and drawing happens, a <em>shapes.js</em> that defines the look and broad functionality of our objects, an <em>agents.js</em> that will tailor the interactions of those objects to this specific game, and an <em>environment.js</em> that defines global constants and interface elements, and a <em>gameFlow.js</em> which will control the scene transitions. This grouping keeps like with like while we figure out what we need — balancing number of files and amount of scrolling.</p>
<h2 id="agents-of-interaction-revisited">Agents of Interaction, Revisited</h2>
<p>The first thing that we need is a player. But do we need a class for that player? One of the key tenets of object-oriented programming (OOP) is that characteristics and abilities of an object are held by that object. Are we going to have attributes and actions that concern <em>only</em> our player? We should probably know what kind of game we are making.</p>
<p>Let’s take some inspiration from <a href="https://agar.io">Agar.io</a>, which took inspiration from <a href="https://www.osmos-game.com/">Osmos</a>. How about Awesome Face wondering around trying to avoid being eaten by bigger enemies while eating smaller ones? We’ll have Smileys and Cool Guys as our baddies. And then we can eat different colored little food pellets that just wobble around.</p>
<p>For our player, we don’t need custom attributes, but we do want to have it move in a way separate from the enemies and pellets — that is, with the mouse. We have function called <em>moveWithMouse()</em>, but it would be nice if we could just call <em>player.move()</em> and it <em>moves with the mouse</em>.</p>
<h3 id="players-gonna-play-play-play-play-play">Players Gonna Play Play Play Play Play</h3>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Let’s make a class called <em>Player</em> that is a <strong>subclass</strong> of <em>Face</em> — that <em>extends</em> <em>Face</em>. We’ll put it in in our new file <em>agents.js</em>. Declare it like we did <em>Face</em>, giving yourself a line between the curly braces.</li>
</ul>
<blockquote>
<p>hint: <img src="playerClass.png" alt="Player class declaration"></p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> For navigation, it’s helpful to have easy-to-see class headers that show us when a class begins. Copy the five lines of slashes from the beginning of <em>Face</em> and paste it above the declaration. Change the header title to match. It may be worthwhile to write down a brief description of what the class does or is expected to do.</li>
</ul>
<blockquote>
<p>info: Headers are great places to put a description <em>in plain English</em> of what a function or a class or even a file does — the things it changes or depends on and such. There are a few descriptions of functions in this code, as well as some separators. You can make them with single line comments as has been done in the code or with multi-line comments <code>/*</code> <code>*/</code>.</p>
</blockquote>
<p>Next we need a <em>constructor()</em>. For our player, we don’t need to add any custom properties at the moment, so we don’t need more <em>this-dots</em> like <code>this.mojo</code> and <code>this.onFleek</code>. We just need to call our superclass <em>constructor()</em> with the four parameters it takes: <em>look</em>, <em>pos</em>, <em>size</em>, and <em>speed</em>.</p>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> The <em>look</em> is going to be <code>"awe"</code>.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> The starting position needs to be a vector which we can put in the middle of the canvas for now, so <code>createVector(width/2,height/2)</code>.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> For <em>size</em>, just put <code>100</code>.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> And let’s give it no <em>speed</em> initially, so <code>createVector(0,0)</code>.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled="">  Don’t forget to use commas in between each parameter. Use <strong>Shift-Tab</strong> to tidy the code so we don’t have to worry about getting the spacing perfect.</p>
</li>
</ul>
<blockquote>
<p>hint: <img src="playerConstructor.png" alt="Player constructor"></p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Let’s test it to make sure it works. In <em>sketch.js</em>, declare <code>player</code> and make it a new <em>Player</em> object in <em>setup()</em>.</li>
</ul>
<blockquote>
<p>hint: Put <code>let player;</code> at the top of <em>sketch.js</em> with the other global variables. Then put <code>player = new Player();</code> in <em>setup()</em>.<br>
<img src="addNewPlayer.png" alt="add new player"></p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Now draw the player <em>after</em> all the other <em>faces</em> are drawn.</li>
</ul>
<blockquote>
<p>hint: Just put <code>player.draw();</code> after the <em>for-of</em> loop that draws and animates the faces in <em>draw()</em>.<br>
<img src="addPlayerDraw.png" alt="add *player.draw()*"></p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Run the code. The <em>player</em> should be stationary in the center of the canvas with mayhem behind it. If it isn’t, go step by step above to make sure you didn’t forget anything.</li>
</ul>
<h3 id="every-move-you-make">Every Move You Make</h3>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Next, we <em>move</em>. Just below <code>player.draw()</code>, put <code>player.move();</code>.</li>
</ul>
<p>Before we run it, we have to define <em>Player.move()</em> — that is, the <em>move()</em> method in the <em>Player</em> class. Recall that sometimes we’ll put the class name in front of a method to differentiate it from methods in other classes. When we call it, it’s either attached to <em>this</em> or the instantiated object like our lowercase <code>player</code>.</p>
<p>Back in <em>agents.js</em>, add a <em>move()</em> method after the <em>constructor()</em> in <em>Player</em>. All that this method is going to do is call <em>moveWithMouse()</em>. Even though the <em>moveWithMouse()</em> method is in a parent class, since we have not redefined it, we can call it as if we defined it here and it will automagically call the parent’s method.</p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Put <code>this.moveWithMouse();</code> in the body of <em>move()</em>.</li>
</ul>
<p><img src="playerMoveWithMouse.png" alt="add *move()* method that calls *moveWithMouse()*"></p>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Now run it. Does <em>player</em> move with the mouse?</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> One final thing with <em>player</em> — in planning for the future, we can give our <em>constructor()</em> a parameter for <em>pos</em> and <em>size</em> with default values so we don’t have to put them in later. Place <code>pos = createVector(height/2,width/2), size = 100</code> in the parentheses for <em>constructor()</em>. Since that runs a bit long, we can put each parameter on its own line like we have been doing.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> We need <em>pos</em> and <em>size</em> to be parameters in <em>super()</em> or this won’t do us any good. Change the second and third parameters to <code>pos</code> and <code>size</code> respectively.</p>
</li>
</ul>
<p><img src="defaultParameters.png" alt="Default parameters for Player constructor"></p>
<blockquote>
<p>info: Some languages like Python and Swift have <strong>named parameters</strong>, giving us the option of which parameters to fill and in what order. However, JS doesn’t have them as of yet, so in the above, if we just put <em>pos</em>, it would fill in the default size, but if we wanted to just change <em>size</em> and get the default <em>pos</em>, it won’t work: <em>pos</em> is always the first parameter, if it exists; <em>size</em> is always the second parameter, if <em>pos</em> and it both exist. There are some rather advanced work-arounds for this like destructuring or simulating constructor overloading if we <em>really</em> needed it, but we <em>really don’t</em>, so we’ll just leave it at that.</p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Test the default parameters. Try giving a different position vector and size than the defaults. You may want to comment out <code>player.move();</code> in <em>sketch.js</em> temporarily just to make sure it’s being drawn in the right place.</li>
</ul>
<p><img src="testDefaultParameters.png" alt="testing the default parameters"></p>
<h3 id="take-it-easy">Take It Easy</h3>
<p>Speaking of <em>Player.move()</em>, it moves with the mouse a little <em>too</em> well — as in perfectly. This is not what we want.</p>
<p>Our aim is to have the player move <em>toward</em> the mouse, not exactly with it. And to do that, we can find a spot in between where the player is and where the mouse is and move the player there. Right now, we know where we are and how fast we are moving but no idea <em>where we are going</em>. So let’s make an <em>aim</em> property.</p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Since this property will be about as useful as <em>this.pos</em> and <em>this.speed</em>, let’s just add it in <em>Ball</em> in the <em>shapes.js</em> file. Put <code>this.aim = null;</code> just below <em>this.speed</em> in the <em>constructor()</em> for <em>Ball</em>.</li>
</ul>
<p><img src="thisAim.png" alt="add this.aim to Ball"></p>
<p>What the null? When a primitive hasn’t been given a value, it’s <em>undefined</em>. When an object hasn’t been instantiated, it’s <em>null</em>. Because <em>this.aim</em> doesn’t need to have a value at construction, we shouldn’t make a parameter for it that will almost immediately be changed, nor should just create a random one for the same reason. But we should give it a value if for no other reason than to get rid of warnings, and <em>null</em> works.</p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> It will also prove useful to add a property that will act as a multiplier for how fast we <em>can</em> go — especially useful for any <em>boost</em> capabilities, so let’s just call it <em>boost</em>. Put it beneath <em>this.aim</em> and give it a value of <code>5</code> for now.</li>
</ul>
<blockquote>
<p>hint: Place <code>this.boost = 5;</code> in the <em>constructor()</em> under <code>this.aim = null;</code><br>
<img src="thisBoost.png" alt="add this.boost to Ball"></p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> In addition to this new property, we can make a new method called <em>easeToward()</em> with a single parameter <em>target</em>. Put <code>easeToward(target) {}</code> below <em>moveWithMouse()</em> in <em>Ball</em>.</li>
</ul>
<p><img src="easeToward.png" alt="Put easeToward() beneath moveWithMouse()"></p>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> But we want it to default to our <em>aim</em> property. Can you give <em>target</em> a default property like before?</li>
</ul>
<blockquote>
<p>hint: <code>easeToward(target = this.aim) {}</code></p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> Let’s take a step back and look at what we want this method to do.</li>
</ul>
<p>We need to know where the mouse is and where our character is so it can close the gap between them. That means getting the distance between them and the direction Awesome Face needs to go. We can use the distance to measure how fast we need to go giving us the speed. Then we can add the speed to our position like we have done to animate the balls and faces.</p>
<p>Easy on the face of it, but a little challenging just seeing the code.</p>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> In the body of this method, we want to make sure that we are not going to change the object passed in as our target parameter, protecting our precious burritos from larcenous older brothers by getting them one in advanced. Write <code>target = target.copy();</code> on the first line. Our target <em>must</em> be a vector or it will give us an error.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Next, we need the distance between our current position and our target, which we’ll call <em>magnitude</em>. Put <code>let magnitude = this.pos.dist(target);</code>.</p>
</li>
</ul>
<blockquote>
<p>info: The <em>dist()</em> method in <em>p5.Vector</em> just takes the difference in the two coordinates and plugs them in as the <em>a</em> and <em>b</em> of the most well-known formula in all of Mathematics and the foundation of Trigonometry — the  Pythagorean theorem:<br>
<img src="pythagoreanTheorem.png" alt="pythagorean theorem"><br>
Sometimes you might wonder <em>when am I ever going to use this!?</em> Well, this is one of those times — even if you didn’t implement it directly.</p>
</blockquote>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled=""> With this <em>magnitude</em>, we can set the speed to go faster when the cursor is further away and slower when nearer. We’ll make that speed based on the <em>size</em> of our character. Set <em>magnitude</em> equal to itself divided by our <em>size</em> property, then multiply it by our <em>boost</em>.</li>
</ul>
<blockquote>
<p>hint: Put <code>magnitude = magnitude / this.size * this.boost;</code>. If you like, you can put parentheses like this <code>(magnitude / this.size)</code> just for clarity, but it’s unnecessary.</p>
</blockquote>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Speed without direction is just standing still, so the first thing we need is a direction to go. Let’s get it by simply subtracting our current position from the target position using <em>p5.Vector.sub()</em>: <code>this.speed = target.sub(this.pos);</code>. We don’t need a copy here because we preemptively took care of it.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Now we can use <em>p5.Vector.setMag()</em> to set the magnitude of our <em>this.speed</em> vector. This is the <em>how fast</em> part of speed. Recall that these methods acting on the vector itself changes the vector so we only need to put <code>this.speed.setMag(magnitude);</code>, not <code>this.speed = this.speed.setMag(magnitude);</code>.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> To wrap up <em>this.easeToward()</em>, we’ll add <em>this.speed</em> to <em>this.pos</em> using <em>p5.Vector.add()</em>. That gives us our new position. Put <code>this.pos.add(this.speed);</code>.</p>
</li>
</ul>
<p><img src="easeTowardImplemented.png" alt="The easeToward() method implemented"></p>
<p>Switch back to <em>Player.move()</em> in <em>agents.js</em>. We need to edit it to call <em>easeToward()</em> instead of <em>moveWithMouse()</em>.</p>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> We can either set <em>this.aim</em> before calling the method or just give it the mouse position vector directly. We will choose the first option because we won’t just want to follow the raw mouse position. Place     <code>this.easeToward());</code> in the body.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Back in <em>sketch.js</em>, put <code>player.aim = createVector(mouseX,mouseY);</code> just before we call <em>player.move()</em>.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Now run the code. You may want to comment out <em>noCursor()</em> in the main <em>setup()</em> function. <strong>Make sure that it works</strong>. Review the instructions and images if it doesn’t.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> One final thing: It would be nice if we could have our character stay in the center instead of zooming off to the edge. Why don’t we just assign <em>mouseX</em> and <em>mouseY</em> to the center of the canvas? Put: <code>mouseX = width / 2;</code> and <code>mouseY = height / 2;</code> in <em>setup()</em>. That does the job.</p>
</li>
</ul>
<p><img src="centerMouse.png" alt="center the mouse on run"></p>
<blockquote>
<p>info: When you get the dude to stay in the center — congrats, you made it to the end of another lesson! <strong>Here is  <a href="http://bit.ly/p5jsLesson9final">the code</a> that ends this lesson.</strong>  You can open it in a new window and compare it to yours.</p>
</blockquote>
<h2 id="time-to-tinker">Time to Tinker</h2>
<ul>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Can you figure out how to adjust how quickly the character tracks the pointer? (It’s a property that we added this lesson.)</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Can you change that property in <em>draw()</em> like we did with <code>this.aim</code>?</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" class="task-list-item-checkbox" disabled=""> Take a look at the code for <em>animateShades()</em>. Do you think you can use that method as a template for speeding up how fast the player moves, like when the mouse button is pressed?</p>
</li>
</ul>
</div>
</body>

</html>
